---
title: "Birth Weight Prediction"
subtitle: |
  | Final Project 
  | Data Science 2 with R (STAT 301-2)
author: "Cassie Lee"
date: today

format:
  html:
    toc: true
    embed-resources: true
    
execute:
  echo: false
  warning: false

from: markdown+emoji 
reference-location: margin
citation-location: margin
bibliography: references.bib
---

```{r}
#| label: load-packages-data

library(tidyverse)
library(tidymodels)
library(here)
library(knitr)

tidymodels_prefer()
```

::: {.callout-tip icon="false"}
## Github Repo Link

[Cassie Lee's Final Project Memo](https://github.com/stat301-2-2024-winter/final-project-2-cassielee2025.git)
:::

# Introduction

The developmental origins of health and disease (DOHaD) is a framework that seeks to link exposures to stressors during windows of susceptibility to the development of non-communicable diseases later in life [@lacagnina2019]. Birth weight has historically been used as an indicator of adverse early life exposures to stressors due to the relative ease of collecting birth weight data [@hanson2015]. Low birth weight is a risk factor for developing non-communicable diseases later in life such as cardiovascular diseases, metabolic diseases, and kidney diseases [@bianchi2022].

## Objective

The objective of this prediction problem is to create a model to predict the birth weight of an infant given a certain set of characteristics. This is a regression problem. Having a prediction model for this problem can be useful in providing insights to eventually developing an inferential question that identifies the most important factors associated with birth weight.

A classification problem to predict whether or not an infant would be born with low birth weight was not feasible with the dataset used because of high class imbalance. Only about 10% of observations in the dataset would have been classified as low birth weight, which is births under 2,500 grams [@hughes2017].

## Data Source

I downloaded the Kaggle dataset, *US births (2018)* [@amoldeshmukh2020]. The creator of this dataset subsetted this data from the raw 2018 natality file available from the Vital Statistics Online Data Portal [@nationalcenterforhealthstatistics2023].

I chose this specific dataset because I searched Kaggle for a dataset relating to birth weight and found the Kaggle competition, *Prediction interval competition I: Birth weight*[^1] by Carl McBride Ellis. Ellis cited the *US births (2018)* dataset as its source. I downloaded the *US births (2018)* dataset to have access to the the full dataset and have more control over the amount of observations I used for exploratory data analysis, the training data, and the testing data.

[^1]: [Kaggle competition](https://www.kaggle.com/competitions/prediction-interval-competition-i-birth-weight/discussion/459133)

The prediction interval competition identified 39 predictors to use, however, due to computational limitations, I selected 20 variables from this list. This selection was done by selecting only variables related to the conditions related to pregnancy — for example, weight gain during pregnancy — and dropping conditions related to birth — for example, the type of facility the birth occured in.

# Data Overview

The *US births (2018)* has over 3 million variables. Due to computational limitations, I subsetted 30,000 observations, using 15,000 for an exploratory data analysis and 15,000 for model fitting and testing.

Because I had the ability to subset from over 3 million observations, I was able to filter out incomplete observations before randomly sampling a total of 30,000 observations. Therefore, I do not have any major missingness issues. @tbl-missingness shows the results of the missingness analysis. This analysis contains observations used in exploratory data analysis, model fitting and tuning, and tesing. Variables are ordered from the greatest to least missing observations, with only the first five variables shown.

Although there are not major missingness issues, @tbl-missingness shows that interval since last pregnancy (`ilp_r`), interval since last birth (`illb_r`), and which month of pregnancy the mother began prenatal care (`precare`) have several missing values. I created missingness in these variables because the original data collection encoded multiple types of information under the same variable. 

For the interval since last pregnancy and last birth, if the mother had a plural delivery, the interval since the last birth was encoded as the number of infants  (0 to 3) the mother had at the time of birth. From this information, I created a logical variable to identify whether or not the birth was a plural delivery and recoded the interval since last birth and last pregnancy as missing. Similarly, if this was the mother's first birth or first pregnancy, the interval since last birth and last pregnancy was encoded as 888. From this information, I created two logical variables to identify whether or not this was the mother's first birth or first pregnancy and recoded the interval since last birth and last pregnancy as missing. For which month of pregnancy the mother began prenatal care, 00 was recorded if the mother did not receive any prenatal care. From this information, I created a logical variable to identify whether or not the mother received prenatal care and recoded the month of pregnancy the mother began prenatal care as missing. I could not filter out these observations due to the information they contained, even as "missing" variables. All other variables are complete.

```{r}
#| label: tbl-missingness
#| echo: false
#| tbl-cap: "Missingness analysis conducted on 30,000 randomly sampled observations."

load(here("memos/memo1_outputs/data_quality_check.rda"))
data_quality_check %>% 
  kable()
```




![Target variable analysis conducted on 30,000 randomly sampled observations.](memos/memo1_outputs/target_variable.png){#fig-target-variable}

# Methods

# Model Building and Selection

# Final Model Analysis

# Conclusion

# References

# Appendix: Exploratory Data Analysis
